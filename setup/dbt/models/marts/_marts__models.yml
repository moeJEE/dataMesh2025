# ============================================================================
# DBT Marts - Model Documentation & Tests
# ============================================================================

version: 2

models:
  - name: mart_sales__customer_lifetime_value
    description: |
      Customer lifetime value analysis combining all customer orders.
      This mart provides key metrics for customer segmentation and retention analysis.
    
    columns:
      - name: customer_id
        description: Unique customer identifier
        tests:
          - unique
          - not_null
      
      - name: customer_name
        description: Company/customer name
      
      - name: lifetime_value
        description: Total revenue from this customer
        tests:
          - not_null
      
      - name: total_orders
        description: Number of orders placed
        tests:
          - not_null
      
      - name: customer_segment
        description: Value-based customer segmentation
        tests:
          - accepted_values:
              values: ['High Value', 'Medium Value', 'Low Value', 'No Orders']
      
      - name: customer_status
        description: Recency-based customer status
        tests:
          - accepted_values:
              values: ['Active', 'At Risk', 'Churned', 'Never Ordered']
  
  - name: mart_lead_to_customer_journey
    description: |
      Cross-domain analysis tracking marketing leads through to sales customers.
      Shows the complete customer journey from first touch to revenue generation.
    
    columns:
      - name: lead_id
        description: Unique lead identifier from marketing
        tests:
          - unique
          - not_null
      
      - name: email
        description: Contact email (join key)
        tests:
          - not_null
      
      - name: is_converted
        description: Whether lead converted to customer
        tests:
          - not_null
      
      - name: days_to_conversion
        description: Days from lead creation to customer conversion
      
      - name: total_revenue
        description: Total revenue generated by this customer
        tests:
          - not_null
      
      - name: customer_value_segment
        description: Customer value classification
        tests:
          - accepted_values:
              values: 
                - 'Not Yet Purchased'
                - 'High Value Customer'
                - 'Medium Value Customer'
                - 'Low Value Customer'

